Stacking Emission Line and Continuum Images from SITELLE Data Cubes

The goal of this project is to produce a pipeline to create stacked images using 3D data cube of imaging-spectroscopic data from the Fourier Transform spectrograph SITELLE at CFHT which produces data equivalent to a very large field-of-view IFU. The student will use the data from cluster  galaxies in both continuum and emission line (H-alpha, [NII]6548, and [NII]6583) from emission line galaxies (ELGs) that have already been identified in a clusters at z~0.23. The goal is to produce stacked images in both emission line and continuum for the faint cluster galaxies in the sample, which will allow the student to measure the average profile and size of the star-formation regions of ELGs with low surface brightness emission line features.

0. Prerequisites:
 The student should have all necessary packages and data already on his computer.
 0.1. The student has been provided SITELLE data cubes of Abell 2390, Abell 2465, and RXJ2129 in the C4 filter, which samples the H-alpha, [NII]6548, and [NII]6583 lines for the cluster galaxies.
 0.2. This project will be done in the Python programming language. He should already have the Anaconda distribution installed and working, with the astroconda environment provided by the STScI, which includes necessary installations such as h5py, astropy, numpy, matplotlib, and scipy.

1. Science
 Satellite galaxies falling into the gravitational potential of a galaxy cluster undergo environmental quenching processes, which halt star-formation in the in-falling galaxy. Current studies indicate this process is rapid, beginning during the initial in-fall and interaction with the intra-cluster medium (ICM), a hot gas which dominates the baryonic matter of a galaxy cluster. The interaction between an in-falling galaxy and the ICM can result in a process called Ram-Pressure Stripping, where the hot ICM interacts with the star-forming gas of the galaxy. This heats the gas and strips it from the gravitational potential of the galaxy. As stars and dark matter are non-collisional, RPS does not affect the distribution of this material. So, RPS disturbs the star-forming gas and modifies the morphology of the ionized gas profile, which is traced by the H-alpha emission line.
 We seek to understand how the process of RPS affects galaxies at all stages of in-fall, and at low masses. However, low mass galaxies, like many cluster satellites, are often faint. By stacking these galaxies, lower surface brightness features and extended profiles can be measured. By comparing the average surface profiles and sizes of ELGs in different regions of the cluster phase space, we can gain insights into how the quenching of star formation proceeds as galaxies in-fall into the cluster; e.g., whether the quenching of star formation is from inside-out or out-side in. providing constraints on the types of quenching mechanisms in operation. The data from the stacked images will allow us to push this analysis to the fainter low-mass in-falling galaxies.

2. Using the SITELLE data cubes and becoming familiar with redshift, wavelength, and wavenumber
 2.1. Using a table of known ELG physical positions within the cube and measured redshifts, the student will identify which data cube "channels" (the 3rd dimension of the data cube) are associated with emission lines vs. the continuum. To do this, the student must determine the redshifted wavelength of the H-alpha and [NII] emission lines and estimate a width of the lines. The student will then convert the wavelengths into wavenumbers, which is the unit in which SITELLE stores its 3rd dimension of the data cubes. The student will then determine the wavenumber positions of the continuum, which will not be associated with noise or emission line wavenumbers. Include a sample calculation for a single galaxy in the writeup.
 2.2. Once the channels associated with emission lines and continuum are determined, add the channels associated with H-alpha, [NII]6548, and [NII]6583 separately in an area around the ELGs position to create a single fits image of each emission line profile. Do the same with the continuum channels to create a single continuum fits image of the ELG. Perform this with all identified candidate ELGs.
 2.3. Create pdf images using matplotlib's imshow() function of each emission line image and the continuum image of each ELG. In the writeup, include one pdf image of the most visually striking emission line and continuum in the studentâ€™s opinion.

3. Stacking the ELGs
 3.1. Once all fits emission line and continuum images have been made, stacks of these images will be created. The first step is to establish the criteria for selecting the sample(s) of galaxies to be stacked (e.g., brightness range, position). There are a few ways to create stacks, and exploration of the best method will be performed by the student:
   3.1.1. Perform a simple sum of the images using numpy's sum() functionality, making sure that the proper centroids for the images being stacked are used. The background should have a flux of zero, with noise.
   3.1.2. Perform a median stack by determining the median flux value at each pixel in a stack of emission lines or continuum.
   3.1.3. Perform an average stack by dividing the summed stack by the number of galaxies in each stack of emission lines and continuum.
   3.1.4. Perform a mode stack by determining the mode flux value (most common flux value) at each pixel for each stack.
 3.2. Use matplotlib's imshow() function to display each type of stack in Hydrogen alpha, the [NII] emission lines, and the continuum image.
 3.3. Analyze the differences between each type of stack, establish objective criteria to determine which method produces the best result. Discuss the benefits or drawbacks of utilizing each type of stack for a size analysis.

4. Size analysis (Optional: only if time allows)
  4.1. Create a curve of growth image of what the student determines is the most reliable stack type. Sum the flux values in increasing circular apertures from the center of the galaxy stacks, until an asymptote or leveling off of flux is found. Do this for each emission line stack and the continuum. Create a plot of distance from the center of the stack vs summed flux internal to that distance, or the curve of growth.
  4.2. Determine the value of the asymptotic flux. From this value, determine the location of the half-light position, or radius, for each stack. This half-light radius will be the position where the flux internal to the aperture is half the value of the asymptotic flux.
  4.3. Plot an image of each stack with a circle overlaid, denoting the half-light radial size of each stack.
  4.4. Determine the physical size of the half light radius of each stack: use astropy.cosmology() to convert the size in arcseconds to a size in kiloparsecs. Make use of astropy.units() and astropy.constants() if needed to determine physical sizes. Assume a flat Lambda CDM cosmology with Omega_matter=0.3, Omega_lambda=0.7, and a Hubble constant of 70 km/s/Mpc. See astropy documentation of the cosmology functions for details.